<div class="flex flex-col gap-4">
  <app-top title="Event Categories" />
  @if (idEvent) {
  <event-info-card [idEvent]="idEvent" />
  }

  <section class="mx-auto w-full max-w-4xl px-4 sm:px-6 lg:px-0">
    <!-- Header + búsqueda (sticky) -->
    <!--

    <div
      class="sticky top-0 z-20 -mx-4 sm:-mx-6 lg:mx-0 px-4 sm:px-6 lg:px-0 py-3 bg-white/80 dark:bg-neutral-900/80 backdrop-blur supports-[backdrop-filter]:bg-white/60 border-b border-neutral-100/70 dark:border-neutral-800"
    >
      <div
        class="flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between"
      >
        <div class="min-w-0">
          <h2 class="text-base font-semibold tracking-tight">
            Elige categorías
          </h2>
          <p class="text-sm text-neutral-500 dark:text-neutral-400">
            Puedes seleccionar una o varias. Usa el buscador si hay muchas.
          </p>
        </div>

        <div class="flex items-center gap-2">
          <label
            class="inline-flex items-center gap-2 select-none cursor-pointer"
          >
            <span class="text-sm text-neutral-600 dark:text-neutral-300"
              >Ver solo seleccionadas</span
            >
            <span class="relative inline-flex items-center">
              <input type="checkbox" class="peer sr-only" />
              <span
                class="h-6 w-10 rounded-full bg-neutral-200 dark:bg-neutral-700 transition peer-checked:bg-indigo-600"
              ></span>
              <span
                class="absolute left-0.5 top-0.5 h-5 w-5 rounded-full bg-white dark:bg-neutral-200 shadow transition peer-checked:translate-x-4"
              ></span>
            </span>
          </label>

          <button
            type="button"
            class="inline-flex items-center gap-2 rounded-xl border border-neutral-200 dark:border-neutral-700 px-3 py-2 text-sm hover:bg-neutral-50 dark:hover:bg-neutral-800"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              class="h-4 w-4"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <path
                d="M3 6h18M8 6v12m8-12v12M5 6l1 14a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2l1-14M10 6V4a2 2 0 0 1 2-2h0a2 2 0 0 1 2 2v2"
              />
            </svg>
            Limpiar
          </button>
        </div>
      </div>

      <div class="mt-3">
        <div class="relative">
          <input
            type="text"
            placeholder="Buscar categorías…"
            class="w-full rounded-2xl border border-neutral-200 dark:border-neutral-700 bg-white/90 dark:bg-neutral-900/90 px-10 py-3 text-sm outline-none focus:ring-2 focus:ring-indigo-500"
          />
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="pointer-events-none absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-neutral-400"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <circle cx="11" cy="11" r="8"></circle>
            <path d="M21 21l-3.5-3.5"></path>
          </svg>
        </div>
      </div>
    </div>
    -->

    <!-- Grid de categorías -->
    <ul class="mt-2 grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3">
      <!-- Item (repítelo con @for; cambia valores por los reales) -->
      @for (item of listCategories; track $index) {
      <li>
        <label
          class="group relative block cursor-pointer rounded-2xl border border-neutral-200 dark:border-neutral-800 bg-white dark:bg-neutral-900 p-3 hover:shadow-sm transition focus-within:ring-2 focus-within:ring-p1"
        >
          <input
            type="checkbox"
            [checked]="isSelected(item.id)"
            (change)="toggleCategory(item.id)"
            class="peer sr-only"
          />

          <div class="flex items-center gap-3">
            <p class="min-w-0 font-medium truncate">{{ item.title }}</p>
          </div>

          <div
            class="pointer-events-none absolute inset-0 rounded-2xl ring-1 ring-transparent peer-checked:ring-p1"
          ></div>
          <div
            class="pointer-events-none absolute right-3 top-3 h-5 w-5 rounded-full bg-white/80 dark:bg-neutral-900/80 ring-1 ring-neutral-300/70 flex items-center justify-center peer-checked:bg-p1 peer-checked:text-white peer-checked:ring-p1"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              class="h-3.5 w-3.5"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="3"
            >
              <path d="M20 6 9 17l-5-5" />
            </svg>
          </div>
        </label>
      </li>
      }
    </ul>

    <div class="sticky bottom-3 mt-6">
      <div
        class="mx-auto w-full max-w-4xl rounded-2xl border bg-white/80 dark:bg-neutral-900/80 border-neutral-200 dark:border-neutral-800 backdrop-blur shadow-lg px-3 py-3 sm:px-4 sm:py-3 flex items-center justify-between gap-3"
      >
        <div class="min-w-0">
          <p class="text-sm">
            <span class="font-medium">{{ listEventCategories.length }}</span>
            categorías seleccionadas
          </p>
          <p class="text-xs text-neutral-500 dark:text-neutral-400 truncate">
            Consejo: puedes seleccionar varias categorias a la vez
          </p>
        </div>
        <div class="flex items-center gap-2">
          <app-button label="Limpiar" type="outline" (pressed)="clear()" />
          <app-button
            label="Guardar"
            type="primary"
            (pressed)="save()"
            [isLoading]="isLoadingSave"
          />
        </div>
      </div>
    </div>
  </section>
</div>
